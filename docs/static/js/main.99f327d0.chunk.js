(this["webpackJsonpheating-visualization"]=this["webpackJsonpheating-visualization"]||[]).push([[0],{192:function(e,t,n){},194:function(e,t,n){},195:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(3),i=n.n(a),o=n(71),s=n.n(o),c=(n(192),n(1)),l=n(2),u=(n(194),{all:["coal","peat","oils","naturalgas","industryreactions","wood","nuclear","electricityimport","hydro","wind","heatpumps","other"],heating:["coal","peat","heavyoil","lightoil","naturalgas","recoveredfossil","woodsmall","recoveredbio","heatpumps"],electricity:["nuclear","electricityimport","hydro","wind","solar"],traffic:["gasoline","diesel","biogasoline","biodiesel","biogas"]}),d=function(e){return{date:new Date(+e.year,0,1),oils:+e.oilstotal,coal:+e.coaltotal,naturalgas:+e.naturalgas,nuclear:+e.nuclearenergy,hydro:+e.hydropower,wind:+e.windpower,wood:+e.woodtotal,peat:+e.peat,heatpumps:+e.heatpumps,other:+e.recoveredrecycledtotal,industryreactions:+e.industryreactions,electricityimport:+e.electricityimport,gasoline:+e.gasoline,biogasoline:+e.biogasoline,diesel:+e.diesel,biodiesel:+e.biodiesel,lpg:+e.lpg,lightoil:+e.lightfueloil,heavyoil:+e.heavyfueloil,otheroils:+e.otheroils+ +e.biofueloil+ +e.recycledoil+ +e.refinerygas,woodsmall:+e.woodsmall,woodindustry:+e.blackliquor+ +e.woodindustry,recoveredfossil:+e.recoveredfossil+ +e.demolitionfossil+ +e.otherwastefuels,recoveredbio:+e.recoveredbio+ +e.demolitionbio+ +e.otherbioenergy,biogas:+e.biogas,solar:+e.solarenergy,hydrogen:+e.hydrogen}},h={all:["coal","peat","heavyoil","lightoil","transportoil","naturalgas","otherfossil","wood","otherbio"],heating:["coal","peat","heavyoil","lightoil","naturalgas","otherfossil","otherbio"],electricity:["coal","peat","heavyoil","lightoil","naturalgas","otherfossil"],traffic:["transportoil"]},f=function(e){return{date:new Date(+e.year,0,1),heavyoil:+e.heavyfueloil,lightoil:+e.lightfueloil+ +e.otheroils,transportoil:+e.transportfuels,coal:+e.coal+ +e.othercoals,naturalgas:+e.naturalgas,peat:+e.peat,otherfossil:+e.year<1990?+e.total:+e.otherfossilfuels+ +e.co2transfer,wood:+e.woodfuels,otherbio:+e.othernonfossilfuels}},j=n(4),b=function(e,t,n,r,a){var i=function(e,n,a){return t*n+r*a[e]},o=Object.entries(n).filter((function(t){var n=Object(c.a)(t,2),r=n[0];n[1];return"date"===r||e.includes(r)})).map((function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return[n,"date"===n?new Date(i(n,r,a)):i(n,r,a)]}));return{values:Object.fromEntries(o),rank:o.filter((function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return"date"!==n&&r>0})).sort((function(e,t){return t[1]-e[1]}))}},g=function(e,t,n){var r,a=[],i=Object(j.a)(Object(l.k)(e));try{for(i.s();!(r=i.n()).done;)for(var o=Object(c.a)(r.value,2),s=o[0],u=o[1],d=0;d<n;++d){var h=d/n,f=1-h;a.push(b(t,f,s,h,u))}}catch(g){i.e(g)}finally{i.f()}return a.push(b(t,0,e[e.length-2],1,e[e.length-1])),a},m=function(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=Object(l.h)(.44-.4*n/e.length);return t},O={oils:"Oil",heavyoil:"Heavy fuel oil",lightoil:"Light fuel oil",transportoil:"Transport fuels",coal:"Coal",naturalgas:"Natural gas",industryreactions:"Industry reactions",peat:"Peat",otherfossil:"Other fossil fuels",wood:"Wood",otherbio:"Other non-fossil fuels",nuclear:"Nuclear energy",hydro:"Hydro power",wind:"Wind power",heatpumps:"Heat pumps",electricityimport:"Electricity import",other:"Recycled sources",gasoline:"Gasoline",biogasoline:"Gasoline bio component",diesel:"Diesel",biodiesel:"Biodiesel",lpg:"Propane",otheroils:"Other oils",woodsmall:"Wood small-scale",woodindustry:"Wood industrial",recoveredfossil:"Fossil waste",recoveredbio:"Non-fossil waste",biogas:"Biogas",solar:"Solar energy",hydrogen:"Hydrogen"},p=function(e){var t=e.data,n=e.frame,i=e.pause,o=e.setPause,s=e.setFilter,c=Object(a.useRef)(),l=t.length>0?t[n].values.date.getFullYear():void 0;return Object(r.jsxs)("div",{className:"Year",children:[Object(r.jsx)("h1",{children:l}),Object(r.jsx)("button",{onClick:function(){return o(!i)},children:i?"\u25b6":"\u25a0"}),Object(r.jsxs)("select",{ref:c,onChange:function(){return s(c.current.value)},children:[Object(r.jsx)("option",{value:"all",children:"All"}),Object(r.jsx)("option",{value:"heating",children:"Heating"}),Object(r.jsx)("option",{value:"electricity",children:"Electricity"}),Object(r.jsx)("option",{value:"traffic",children:"Traffic"})]})]})},y=function(e){var t=e.unit,n=e.data,i=e.frame,o=e.setFrame,s=e.keys,c=e.colors,u=e.target,d=Object(a.useRef)();return Object(a.useEffect)((function(){if(0!==n.length){var e=d.current.clientWidth-60-10,t=d.current.clientHeight-10-30,r=Object(l.q)(d.current).select(".wrap"),a=Object(l.r)().keys(s)(n.map((function(e){return e.values}))),h=Object(l.p)().domain(Object(l.f)(n.map((function(e){return e.values.date})))).range([0,e]),f=Object(l.o)().domain([0,Object(l.j)(a,(function(e){return Object(l.j)(e.map((function(e){return e[1]})))}))]).range([t,0]);r.select(".xaxis").call(Object(l.b)(h)),r.select(".yaxis").call(Object(l.c)(f)),r.select(".fills").selectAll(".area").data(a).join("path").attr("class","area").style("fill",(function(e){return c[e.key]})).attr("d",Object(l.a)().x((function(e){return h(e.data.date)})).y0((function(e){return f(e[0])})).y1((function(e){return f(e[1])}))),r.select(".year").call((function(e){return e.transition().duration(250).ease(l.e).attr("x",h(n[i].values.date))})),r.on("mousedown",(function(t){t.preventDefault(),Object(l.q)(window).on("mousemove",(function(t){var r=Object(l.q)(d.current).node().getBoundingClientRect(),a=Math.max(Math.min(Object(l.l)(t)[0]-r.x-60,e-1),0);o(Math.floor(a/e*n.length))})).on("mouseup",(function(){Object(l.q)(window).on("mousemove",null).on("mouseup",null)}))})),void 0!==u&&r.selectAll(".target").data([u]).join("rect").attr("class","target").attr("y",(function(e){return f(e)}))}}),[n,i,o,s,c,u]),Object(r.jsx)("div",{className:"Timeline",children:Object(r.jsx)("svg",{ref:d,children:Object(r.jsxs)("g",{className:"wrap",children:[Object(r.jsx)("text",{className:"unit",children:t}),Object(r.jsx)("g",{className:"xaxis"}),Object(r.jsx)("g",{className:"yaxis"}),Object(r.jsx)("g",{className:"fills"}),Object(r.jsx)("rect",{className:"year"})]})})})},v=function(e){var t=e.data,n=e.frame,i=e.setFrame,o=e.pause,s=e.names,u=e.colors,d=e.reverse,h=Object(a.useRef)();return Object(a.useEffect)((function(){if(0!==t.length){var e=h.current.clientWidth,r=h.current.clientHeight,a=t.length-1,f=Object(l.q)(h.current),j=Object(l.o)().domain([0,Object(l.j)(t,(function(e){return Object(l.j)(e.rank.map((function(e){var t=Object(c.a)(e,2);t[0];return t[1]})))}))]).range(d?[e,0]:[0,e]),b=Object(l.n)().domain(Object(l.m)(8)).range([0,r]).padding(.1),g=f.transition().duration(250).ease(l.e),m=b.bandwidth(),O=.4*m,p=function(e){return e+O},y=function(e){return d?e-O/4:e+O/4},v=function(e,r){return n>0&&t[n-1].values[e]||0},x=function(e,r){return n<a&&t[n+1].values[e]||0},w=d?function(e){return j(e)}:function(e){return j(0)},k=d?function(e){return Math.max(j(0)-j(e),0)}:function(e){return Math.max(j(e)-j(0),0)},F=Object(l.g)(",d"),C=function(e,t){var n=Object(l.i)(e,t);return function(e){this.textContent=F(n(e))}};f.selectAll(".bar").data(t[n].rank.slice(0,8),(function(e){var t=Object(c.a)(e,2),n=t[0];t[1];return n})).join((function(e){return e.append("rect").attr("fill",(function(e){var t=Object(c.a)(e,2),n=t[0];t[1];return u[n]})).attr("class","bar").attr("x",(function(e){var t=Object(c.a)(e,2),n=t[0];t[1];return w(v(n))})).attr("y",(function(e){return r})).attr("width",(function(e){var t=Object(c.a)(e,2),n=t[0];t[1];return k(v(n))})).attr("height",m)}),(function(e){return e}),(function(e){return e.call((function(e){return e.transition(g).attr("x",(function(e){var t=Object(c.a)(e,2),n=t[0];t[1];return w(x(n))})).attr("y",(function(e){return r})).attr("width",(function(e){var t=Object(c.a)(e,2),n=t[0];t[1];return k(x(n))})).remove()}))})).call((function(e){return e.transition(g).attr("x",(function(e){var t=Object(c.a)(e,2),n=(t[0],t[1]);return w(n)})).attr("y",(function(e,t){return b(t)})).attr("width",(function(e){var t=Object(c.a)(e,2),n=(t[0],t[1]);return k(n)}))})),f.selectAll(".label").data(t[n].rank.slice(0,8),(function(e){var t=Object(c.a)(e,2),n=t[0];t[1];return n})).join((function(e){return e.append("text").attr("class","label").attr("text-anchor",!0===d?"end":"start").text((function(e){var t=Object(c.a)(e,2),n=t[0];t[1];return s[n]})).attr("x",y(j(0))).attr("y",(function(e){return p(r)})).call((function(e){return e.append("tspan").attr("x",y(j(0))).attr("dy","1.15em")}))}),(function(e){return e}),(function(e){return e.call((function(e){return e.transition(g).attr("y",(function(e){return p(r)})).remove().call((function(e){return e.select("tspan").tween("text",(function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return C((v(n),r))}))}))}))})).call((function(e){return e.transition(g).attr("y",(function(e,t){return p(b(t))})).call((function(e){return e.select("tspan").tween("text",(function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return C(v(n),r)}))}))})),!o&&n<a&&g.on("end",(function(){return i(n+1)}))}}),[t,n,i,o,s,u,d]),Object(r.jsx)("div",{className:"BarChartRace",children:Object(r.jsx)("svg",{ref:h})})},x=function(e){var t=e.show,n=e.hide;return t?Object(r.jsx)("div",{className:"dialog-shadow",onClick:function(){return n()},children:Object(r.jsxs)("div",{className:"dialog-box",children:[Object(r.jsx)("button",{className:"dialog-close",title:"Close",onClick:function(){return n()},children:"X"}),Object(r.jsx)("h3",{children:"Data Transparency Statement"}),Object(r.jsxs)("p",{children:[Object(r.jsx)("a",{href:"https://www.stat.fi/index_en.html",children:"Statistics Finland"})," publishes time series of yearly primary energy consumption\xb9 by energy source from 1960 to 2018 and greenhouse gas, more specifically carbon dioxide (CO\u2082), emissions\xb2 by fuel from 1990 to 2018. Statistics Finland works as a government established public authority which under review provides statistics for decision making and research. One of their responsibilities is the annual national inventory report on greenhouse gases for United Nations Framework Convention on Climate Change. The data collection for that is accepted as defined in national inventory system and carried out with the Finnish Environment Institute, the Natural Resources Institute, and the VTT Technical Research Center of Finland. For energy consumption they collect data from Finnish energy organisations and directly from industry. The data is as current as official statistics get. It is updated yearly but lags 1-2 years behind."]}),Object(r.jsx)("p",{children:Object(r.jsxs)("ol",{children:[Object(r.jsx)("li",{children:Object(r.jsx)("a",{href:"https://pxhopea2.stat.fi/sahkoiset_julkaisut/energia2019/html/engl0000.htm",children:"1.1-5 Total energy consumption by energy source"})}),Object(r.jsx)("li",{children:Object(r.jsx)("a",{href:"https://pxhopea2.stat.fi/sahkoiset_julkaisut/energia2019/html/engl0011.htm",children:"12.3.1 Carbon dioxide emissions by fuels"})})]})}),Object(r.jsx)("p",{children:"* This visualization incorporates energy consumption data starting from 1960. However, emission data by fuels exists only since 1990. Before that from 1970 we visualize just total emission level that is available in the data."}),Object(r.jsxs)("p",{children:["* For animation purposes we interpolate data points between years. Linear interpolation ",Object(r.jsx)("strong",{children:"ignores seasonal variance inside each year"}),"which would in reality display as pulsing change peaking every winter."]}),Object(r.jsx)("p",{children:"* The red level at the energy sector CO\u2082 emissions timeline marks 40% reduction from 1990 level. This is the minimum 2030 reduction goal set for whole EU to meet Paris agreement. In practice, goals for individual countries are agreed separately and Finland's targets are more ambitious. Also the target emission levels are already argued to be too high to meet the Paris climate goals. We will keep the overal 40% guideline here as the actual goals are agreed inside different economical sectors."})]})}):Object(r.jsx)(r.Fragment,{})},w=function(){var e=Object(a.useState)([]),t=Object(c.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)([]),s=Object(c.a)(o,2),j=s[0],b=s[1],w=Object(a.useState)([]),k=Object(c.a)(w,2),F=k[0],C=k[1],N=Object(a.useState)([]),T=Object(c.a)(N,2),S=T[0],E=T[1],H=Object(a.useState)({}),B=Object(c.a)(H,2),I=B[0],R=B[1],D=Object(a.useState)({}),P=Object(c.a)(D,2),A=P[0],M=P[1],W=Object(a.useState)(0),q=Object(c.a)(W,2),z=q[0],Y=q[1],L=Object(a.useState)(!1),G=Object(c.a)(L,2),J=G[0],_=G[1],U=Object(a.useState)("all"),V=Object(c.a)(U,2),X=V[0],K=V[1],Q=Object(a.useState)(!1),Z=Object(c.a)(Q,2),$=Z[0],ee=Z[1],te=Object(a.useState)(0),ne=Object(c.a)(te,2),re=ne[0],ae=ne[1];Object(a.useEffect)((function(){Object(l.d)("primaryenergy.csv",d).then((function(e){return i(e)})),Object(l.d)("energysectorco2.csv",f).then((function(e){return b(e)}))}),[]),Object(a.useEffect)((function(){if(n.length>0&&j.length>0){var e=g(n,u[X],3),t=[n[0].date.getFullYear(),j[0].date.getFullYear()],r=g(function(e,t){for(var n=[],r=e;r<t;r++)n.push({date:new Date(r,0,1),heavyoil:0,lightoil:0,transportoil:0,coal:0,naturalgas:0,peat:0,otherfossil:0,wood:0,otherbio:0});return n}(t[0],t[1]).concat(j),h[X],3),a=r.length>0?Object.entries(r[90].values).filter((function(e){return"date"!==e[0]})).reduce((function(e,t){return e+t[1]}),0):0;C(e),R(m(u[X])),E(r),M(m(h[X])),ae(.4*a)}}),[n,j,X]);return Object(r.jsxs)("div",{style:{position:"relative",minHeight:"100%"},children:[Object(r.jsxs)("div",{className:"App",children:[Object(r.jsxs)("div",{className:"left column",children:[Object(r.jsx)("h1",{children:"Energy consumption by source"}),Object(r.jsx)(v,{data:F,frame:z,setFrame:Y,pause:J,names:O,colors:I}),Object(r.jsx)(y,{unit:"TJ",data:F,frame:z,setFrame:Y,keys:u[X],colors:I})]}),Object(r.jsxs)("div",{className:"right column",children:[Object(r.jsx)("h1",{children:"Energy sector carbon dioxide emissions"}),Object(r.jsx)(v,{data:S,frame:z,setFrame:Y,pause:J,names:O,colors:A,reverse:!0}),Object(r.jsx)(y,{unit:"10\u2079 CO\u2082",data:S,frame:z,setFrame:Y,keys:h[X],colors:A,target:re})]}),Object(r.jsxs)("div",{className:"center",children:[Object(r.jsx)(p,{data:F,frame:z,pause:J,setPause:_,setFilter:K}),"heating"===X&&Object(r.jsx)("p",{children:"Includes combined electricity production."}),"electricity"===X&&Object(r.jsx)("p",{children:"Excludes electricity from combined heat production."}),Object(r.jsx)("p",{className:"red",children:"Rough target level at 2030"})]})]}),Object(r.jsxs)("footer",{children:[Object(r.jsx)("button",{className:"transparency",title:"Transparency Badge",onClick:function(e){var t=e.target;ee(!$),t.blur()},children:"\ud83d\udd75\ufe0f data transparency statement"}),"\xa0| ",Object(r.jsx)("a",{href:"https://creativecommons.org/licenses/by/4.0/",children:"content license CC BY 4.0"}),"\xa0| ",Object(r.jsx)("a",{href:"https://github.com/teemulehtinen/energy-in-finland-visualization",children:"open source MIT at GitHub"})]}),Object(r.jsx)(x,{show:$,hide:function(){return ee(!1)}})]})},k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,196)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),i(e),o(e)}))};s.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(w,{})}),document.getElementById("root")),k()}},[[195,1,2]]]);
//# sourceMappingURL=main.99f327d0.chunk.js.map